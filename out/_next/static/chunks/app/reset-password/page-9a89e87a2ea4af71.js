(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[700],{3778:(e,t,s)=>{Promise.resolve().then(s.bind(s,9393))},9393:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var a=s(5155),o=s(2115),r=s(9195),n=s(3966),c=s(6046),l=s(2818);function i(){return(0,a.jsx)(o.Suspense,{fallback:(0,a.jsx)("div",{className:"text-center my-5",children:"Loading..."}),children:(0,a.jsx)(d,{})})}function d(){let[e,t]=(0,o.useState)("Redirecting to LangQuest app..."),[s,i]=(0,o.useState)(""),[d,u]=(0,o.useState)(!1),h=(0,c.useSearchParams)(),p=(0,r.UU)("https://unsxkmlcyxgtgmtzfonb.supabase.co/",l.env.NEXT_PUBLIC_SUPABASE_ANON_KEY),m=()=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),w=(0,o.useCallback)(async()=>{var e,s,a;let o=h.get("access_token")||(null===(e=window.location.hash.match(/access_token=([^&]*)/))||void 0===e?void 0:e[1]),r=h.get("refresh_token")||(null===(s=window.location.hash.match(/refresh_token=([^&]*)/))||void 0===s?void 0:s[1]),n=h.get("type")||(null===(a=window.location.hash.match(/type=([^&]*)/))||void 0===a?void 0:a[1]);if(m()){let e="langquest://reset-password#access_token=".concat(o,"&refresh_token=").concat(r,"&type=").concat(n),t=Date.now(),s=document.createElement("iframe");s.style.display="none",s.src=e,document.body.appendChild(s),setTimeout(()=>{Date.now()-t<3e3&&(window.location.href="https://play.google.com/store/apps/details?id=com.etengenesis.langquest")},2e3),window.location.href=e}else try{let{error:e}=await p.auth.setSession({access_token:o,refresh_token:r});if(e)throw e;u(!0),t("")}catch(e){console.error("Error setting session:",e),t("Error: Invalid or expired reset link. Please request a new password reset."),i("red")}},[h,p]);(0,o.useEffect)(()=>{w()},[w,h]);let f=async e=>{e.preventDefault();let s=e.target.elements.namedItem("password").value;try{let{error:e}=await p.auth.updateUser({password:s});if(e)throw e;t("Password successfully updated! You can now close this window and log in to the app."),u(!1)}catch(e){console.error("Error updating password:",e),e instanceof Error||e instanceof n.lR?i(e.message):i("An unexpected error occurred")}};return(0,a.jsxs)("div",{className:"container mx-auto px-4",children:[e&&(0,a.jsx)("div",{id:"message",className:"text-center my-5 ".concat(s?"text-red-500":""),children:e}),d&&(0,a.jsxs)("form",{onSubmit:f,className:"max-w-md mx-auto my-10 p-5",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold mb-5",children:"Reset Your Password"}),(0,a.jsx)("input",{type:"password",name:"password",className:"w-full p-2 mb-2 border rounded",placeholder:"Enter new password",required:!0}),(0,a.jsx)("button",{type:"submit",className:"w-full p-2 mt-4 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Reset Password"}),s&&(0,a.jsx)("div",{className:"text-red-500 mt-2",children:s})]})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[504,441,517,358],()=>t(3778)),_N_E=e.O()}]);